<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: design/tree/MapNode.mjs</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: design/tree/MapNode.mjs</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @copyright 2019 Asimovian LLC
 * @license MIT https://github.com/asimovian/plur/blob/master/LICENSE.txt
 * @module plur/design/tree/MapTreeNode
 */
'use strict';

import PlurObject from '../../../plur/PlurObject.mjs';
import ITreeNode from '../../../plur/design/tree/INode.mjs';

/**
 * Tree backed by a {} map.
 *
 * @implements {ITreeNode}
 */
export default class MapTreeNode {
    constructor(value, parent, key) {
        this._value = value || null;
        this._parent = parent || null;
        this._key = key || null;
        this._children = {};
    }
};

PlurObject.plurify('plur/design/tree/MapNode', MapTreeNode, [ITreeNode]);

/**
 * Gets the value for this node.
 *
 * @function plur/design/tree/MapNode.prototype.get
 * @returns mixed|null value
 */
MapTreeNode.prototype.get = function() {
   return this._value;
};

/**
 * Sets the value for this node.
 *
 * @function plur/design/tree/MapNode.prototype.set
 * @param mixed value
 * @returns mixed|null
 */
MapTreeNode.prototype.set = function(value) {
    this._value = value;
};

 /**
 * Retrieves children of this node.
 * If a constructor is provided, only children that are instances of such will be returned.
 *
 * @function plur/design/tree/MapNode.prototype.children
 * @param Function instanceOfConstructor|undefined Filters out all children that are not derived from this constructor
 * @returns plur/design/tree/MapNode[]
 */
MapTreeNode.prototype.children = function(instanceOfConstructor) {
    var children = PlurObject.values(this._children);

    if (PlurObject.isConstructor(instanceOfConstructor)) {
        var filtered = [];
        for (var i = 0, n = children.length; i &lt; n; ++i) {
            if (children[i] instanceof instanceOfConstructor) {
                filtered.push(children[i]);
            }
        }

        children = filtered;
    }

    return children;
};

/**
 * Retrieves the parent.
 *
 * @function plur/design/tree/MapNode.prototype.parent
 * @returns plur/design/tree/MapNode|null parent
 */
MapTreeNode.prototype.parent = function() {
    return this._parent;
};

/**
 * Adds a child.
 *
 * @function plur/design/tree/MapNode.prototype.addChild
 * @param plur/design/tree/MapNode child
 * @returns plur/design/tree/MapNode child
 */
MapTreeNode.prototype.addChild = function(child) {
    if (!child instanceof MapTreeNode) {
        throw new TypeError('Invalid MapTreeNode child', {child: child});
    }

    this._children[child.key()] = child;
    return child;
};

/**
 * Removes a child.
 *
 * @function plur/design/tree/MapTreeNode.prototype.removeChild
 * @param plur/design/tree/MapTreeNode childOrKey
 *      | string key
 */
 MapTreeNode.prototype.removeChild = function(childOrKey) {
    if (childOrKey instanceof MapTreeNode) {
        var child = childOrKey;
        if (typeof this._children[child.key()] === 'undefined') {
            throw new StateError('Child not found', {key: key})
        }

        child._parent = null;
        delete this._children[child.key()];
    } else if (typeof childOrKey === 'string') {
        var key = childOrKey;
        if (typeof this._children[key] === 'undefined') {
            throw new StateError('Child not found', {key: key})
        }

        var child = this._children[key];
        child._parent = null;
        delete this._children[key];
    } else {
        throw new TypeError('Invalid argument', {childOrKey: childOrKey});
    }
};

/**
 * Determines whether a child exists or not.
 *
 * @function plur/design/tree/MapNode.prototype.hasChild
 * @param plur/design/tree/MapNode|string childOrKey The child to search for.
 * @returns boolean hasChild TRUE if child exists. FALSE if not.
 */
MapTreeNode.prototype.hasChild = function(childOrKey) {
    if (typeof childOrKey === 'string') {
        return ( typeof this._children[childOrKey] !== 'undefined' ) ;
    } else if (childOrKey instanceof MapTreeNode) {
        var child = childOrKey;
        for (var key in this._children) {
            if (typeof this._children[key] === child) {
                return true;
            }
        }

        return false;
    } else {
        throw new TypeError('Invalid childOrKey', {childOrKey: childOrKey});
    }
};


/**
 * Retrieves the specified child.
 *
 * @function plur/design/tree/MapNode.prototype.child
 * @param string key
 * @returns plur/design/tree/MapNode|null child NULL if not found.
 */
MapTreeNode.prototype.child = function(key) {
    if (typeof this._children[key] !== 'undefined') {
        return this._children[key];
    }

    return null;
};

/**
 * Determines whether this node is the root node of the tree or not.
 *
 * @function plur/design/tree/MapNode.prototype.isRoot
 * @returns boolean TRUE if this node is the root of the tree, FALSE if not
 */
MapTreeNode.prototype.isRoot = function() {
    return ( this._parent === null );
};

/**
 * Retrieves the root node for this tree.
 *
 * @function plur/design/tree/MapNode.prototype.root
 * @returns plur/design/tree/MapNode root
 */
MapTreeNode.prototype.root = function() {
    var branch = this;
    while (branch._parent !== null) {
        branch = branch._parent;
    }

    return branch;
};

/**
 * Determines whether this node is childless or not.
 *
 * @function plur/design/tree/MapNode.prototype.isLeaf
 * @returns boolean
 */
MapTreeNode.prototype.isLeaf = function() {
    return ( Object.keys(this._children).length === 0 );
};

/**
 * Factory method that creates a new child branch chain, each subsequent child branch corresponding to its main in the
 * provided array.
 *
 * If the provided skeleton uses string keys as elements, children will be constructed using the constructor. Otherwise,
 * pre-created MapTreeNode elements will be added.
 *
 * @function plur/design/tree/MapNode.prototype.expand
 * @param string[] treeList An array to be walked. An array of arrays specifies multiple branches, and can be complex.
 *      | {} treeMap A map to be walked. Can be complex.
 * @param Function valueConstructor Will construct a value object and fill the new node
 *      | Function(plur/design/tree/INode parent := plur/design/tree/INode newChild) constructionCallback
 *          A callback can be used to manually create and return each child.
 * @returns plur/design/tree/INode newLeaves[] All new leaf nodes are returned
 */
 MapTreeNode.prototype.expand = function(treeList, valueConstructor) {
    var branch = this;

    if (Array.isArray(treeList)) {
        for (var i = 0, n = treeList.length; i &lt; n; ++i) {
            var key = treeList[i];

            if (branch.key() === key) {
                continue;
            } else if (branch.hasChild(key)) {
                branch = branch.child(key);
            } else {
                //TODO: if (PlurObject.isConstructor(valueConstructor)) {
                branch = branch.addChild(new MapTreeNode(new valueConstructor(), branch, key));
            }
        }
    } else { // treeMap
        var treeMap = treeList;
        for (var key in treeMap) {
                //TODO: if (PlurObject.isConstructor(valueConstructor)) {
                branch = branch.addChild(new MapTreeNode(new valueConstructor(), branch, key));
                branch.expand(treeMap[key]);
        }
    }

    return branch;
};


MapTreeNode.prototype.key = function() {
    return this._key;
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-plur_api_API.html">plur/api/API</a></li><li><a href="module-plur_api_Bootstrap.html">plur/api/Bootstrap</a></li><li><a href="module-plur_api_PlurAPI.html">plur/api/PlurAPI</a></li><li><a href="module-plur_app_IApplication.html">plur/app/IApplication</a></li><li><a href="module-plur_browser_Bootstrap.html">plur/browser/Bootstrap</a></li><li><a href="module-plur_browser_file_System.html">plur/browser/file/System</a></li><li><a href="module-plur_design_singleton_ASingleton.html">plur/design/singleton/ASingleton</a></li><li><a href="module-plur_design_tree_INode.html">plur/design/tree/INode</a></li><li><a href="module-plur_design_tree_MapTreeNode.html">plur/design/tree/MapTreeNode</a></li><li><a href="module-plur_error_Assertion.html">plur/error/Assertion</a></li><li><a href="module-plur_error_Destroyed.html">plur/error/Destroyed</a></li><li><a href="module-plur_error_Error.html">plur/error/Error</a></li><li><a href="module-plur_error_Interface.html">plur/error/Interface</a></li><li><a href="module-plur_error_State.html">plur/error/State</a></li><li><a href="module-plur_error_Type.html">plur/error/Type</a></li><li><a href="module-plur_event_Emitter.html">plur/event/Emitter</a></li><li><a href="module-plur_event_Event.html">plur/event/Event</a></li><li><a href="module-plur_file_ASystem.html">plur/file/ASystem</a></li><li><a href="module-plur_file_ISystem.html">plur/file/ISystem</a></li><li><a href="module-plur_file_system_API.html">plur/file/system/API</a></li><li><a href="module-plur_file_system_Local.html">plur/file/system/Local</a></li><li><a href="module-plur_http_file_System.html">plur/http/file/System</a></li><li><a href="module-plur_IPlurified.html">plur/IPlurified</a></li><li><a href="module-plur_log_Log.html">plur/log/Log</a></li><li><a href="module-plur_log_System.html">plur/log/System</a></li><li><a href="module-plur_model_IModeling.html">plur/model/IModeling</a></li><li><a href="module-plur_model_Model.html">plur/model/Model</a></li><li><a href="module-plur_nodejs_Bootstrap.html">plur/nodejs/Bootstrap</a></li><li><a href="module-plur_nodejs_file_System.html">plur/nodejs/file/System</a></li><li><a href="module-plur_PlurObject.html">plur/PlurObject</a></li><li><a href="module-plur_terminal_HttpBrowser.html">plur/terminal/HttpBrowser</a></li><li><a href="module-plur_test_Test.html">plur/test/Test</a></li><li><a href="module-plur_test_Tester.html">plur/test/Tester</a></li><li><a href="module-plur_user_ITerminal.html">plur/user/ITerminal</a></li><li><a href="module-plur_user_terminal_Browser.html">plur/user/terminal/Browser</a></li><li><a href="module-plur_user_terminal_Shell.html">plur/user/terminal/Shell</a></li><li><a href="plur_api_build.module_meta.html">meta</a></li></ul><h3>Classes</h3><ul><li><a href="module-plur_api_API.html">plur/api/API</a></li><li><a href="module-plur_api_Bootstrap.html">plur/api/Bootstrap</a></li><li><a href="module-plur_api_PlurAPI-PlurAPI.html">PlurAPI</a></li><li><a href="module-plur_app_IApplication.html">plur/app/IApplication</a></li><li><a href="module-plur_browser_Bootstrap.html">plur/browser/Bootstrap</a></li><li><a href="module-plur_browser_file_System.html">plur/browser/file/System</a></li><li><a href="module-plur_design_singleton_ASingleton.html">plur/design/singleton/ASingleton</a></li><li><a href="module-plur_design_tree_INode.html">plur/design/tree/INode</a></li><li><a href="module-plur_design_tree_MapTreeNode.html">plur/design/tree/MapTreeNode</a></li><li><a href="module-plur_error_Assertion.html">plur/error/Assertion</a></li><li><a href="module-plur_error_Destroyed.html">plur/error/Destroyed</a></li><li><a href="module-plur_error_Error.html">plur/error/Error</a></li><li><a href="module-plur_error_Interface.html">plur/error/Interface</a></li><li><a href="module-plur_error_State.html">plur/error/State</a></li><li><a href="module-plur_error_Type.html">plur/error/Type</a></li><li><a href="module-plur_event_Emitter.html">plur/event/Emitter</a></li><li><a href="module-plur_event_Emitter-plur_event_Emitter._Listener%250A_.html">plur/event/Emitter._Listener
*</a></li><li><a href="module-plur_event_Emitter-plur_event_Emitter._ListenerTreeValue%250A_.html">plur/event/Emitter._ListenerTreeValue
*</a></li><li><a href="module-plur_event_Event.html">plur/event/Event</a></li><li><a href="module-plur_file_ASystem.html">plur/file/ASystem</a></li><li><a href="module-plur_file_ISystem.html">plur/file/ISystem</a></li><li><a href="module-plur_file_system_API.html">plur/file/system/API</a></li><li><a href="module-plur_file_system_Local.html">plur/file/system/Local</a></li><li><a href="module-plur_http_file_System.html">plur/http/file/System</a></li><li><a href="module-plur_IPlurified.html">plur/IPlurified</a></li><li><a href="module-plur_log_Log.html">plur/log/Log</a></li><li><a href="module-plur_log_System.html">plur/log/System</a></li><li><a href="module-plur_model_IModeling.html">plur/model/IModeling</a></li><li><a href="module-plur_model_Model-plur_model_Model.html">plur/model/Model</a></li><li><a href="module-plur_nodejs_Bootstrap-NodeJsBootstrap.html">NodeJsBootstrap</a></li><li><a href="module-plur_nodejs_file_System.html">plur/nodejs/file/System</a></li><li><a href="module-plur_PlurObject.html">plur/PlurObject</a></li><li><a href="module-plur_terminal_HttpBrowser.html">plur/terminal/HttpBrowser</a></li><li><a href="module-plur_test_Test.html">plur/test/Test</a></li><li><a href="module-plur_test_Tester.html">plur/test/Tester</a></li><li><a href="module-plur_user_terminal_Browser.html">plur/user/terminal/Browser</a></li><li><a href="module-plur_user_terminal_Shell.html">plur/user/terminal/Shell</a></li></ul><h3>Interfaces</h3><ul><li><a href="module-plur_user_ITerminal.html">plur/user/ITerminal</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Sep 26 2019 19:03:47 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
